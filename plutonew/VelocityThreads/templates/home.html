{% extends "base.html" %}

{% block title %}Home - E-Commerce {% endblock %}

{% block content %}
<!-- Responsive Two-Column Hero Section -->
<section class="hero-section">
    <div class="container-fluid h-100">
        <div class="row h-100 align-items-center">
            <!-- Left Side - Content -->
            <div class="col-lg-6 col-md-12 hero-content">
                <div class="hero-text-container">
                    <h1 class="hero-heading">
                        <span class="hero-line-1"><i>RACE READY</i></span><br>
                        <span class="hero-line-2">STREETWEAR</span>
                    </h1>
                    <p class="hero-subheading">
                        Formula 1 inspired apparel for the urban athlete. Premium quality, racing heritage.
                    </p>
                    <div class="hero-button-container">
                        <a href="#products" class="btn btn-danger btn-lg">
                            <i class="fas fa-shopping-bag me-2"></i>Shop Now
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Right Side - Image -->
            <div class="col-lg-6 col-md-12 hero-image-container">
                <div class="hero-image-wrapper">
                    <img src="{{ url_for('static', filename='images/hero-banner.jpeg') }}" 
                         alt="Racing Streetwear" 
                         class="hero-image">
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Products Section -->
<section id="products" class="fade-in py-5">
    <div class="container">
        <!-- Section Heading -->
        <div class="row justify-content-center mb-5">
            <div class="col-lg-8 col-md-10 col-12 text-center">
                <h2 class="section-heading mb-3">TRENDING NOW</h2>
                <p class="section-subheading">The most coveted pieces from our racing-inspired collection</p>
            </div>
        </div>
        
        <!-- Search and Filters -->
        <div class="row mb-4">
            <!-- Search Bar - Top Middle -->
            <div class="col-lg-6 col-md-8 col-12 mx-auto mb-3">
                <div class="input-group">
                    <input type="text" class="form-control" id="searchInput" placeholder="Search products by name, description, category, or subcategory...">
                    <button class="btn btn-outline-primary" type="button" id="searchBtn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
            
            <!-- Filters - Top Right -->
            <div class="col-lg-6 col-md-4 col-12 text-end">
                <div class="dropdown d-inline-block me-2">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="categoryFilter" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-filter me-1"></i>Category
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="categoryFilter">
                        <li><a class="dropdown-item" href="#" data-category="all">All Categories</a></li>
                        <li><a class="dropdown-item" href="#" data-category="clothing">Clothing</a></li>
                        <li><a class="dropdown-item" href="#" data-category="accessories">Accessories</a></li>
                        <li><a class="dropdown-item" href="#" data-category="footwear">Footwear</a></li>
                        <li><a class="dropdown-item" href="#" data-category="sports">Sports</a></li>
                    </ul>
                </div>
                
                <div class="dropdown d-inline-block me-2">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="subcategoryFilter" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-tags me-1"></i>Subcategory
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="subcategoryFilter">
                        <li><a class="dropdown-item" href="#" data-subcategory="all">All Subcategories</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="shirts">Shirts</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="tshirts">T-Shirts</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="pants">Pants</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="jeans">Jeans</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="jackets">Jackets</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="hoodies">Hoodies</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="shoes">Shoes</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="caps">Caps</a></li>
                        <li><a class="dropdown-item" href="#" data-subcategory="watches">Watches</a></li>
                    </ul>
                </div>
                
                <div class="dropdown d-inline-block">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="priceFilter" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-sort-amount-down me-1"></i>Price
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="priceFilter">
                        <li><a class="dropdown-item" href="#" data-price="all">All Prices</a></li>
                        <li><a class="dropdown-item" href="#" data-price="low">Under ₹500</a></li>
                        <li><a class="dropdown-item" href="#" data-price="medium">₹500 - ₹1000</a></li>
                        <li><a class="dropdown-item" href="#" data-price="high">Over ₹1000</a></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            {% for product in products %}
            <div class="col">
                <div class="card h-100">
                    {% if product.image_url %}
                    <img src="{{ product.image_url }}" class="card-img-top product-image lazy-load" alt="{{ product.name }}">
                    {% else %}
                    <div class="card-img-top product-image bg-light d-flex align-items-center justify-content-center">
                        <i class="fas fa-image text-muted" style="font-size: 3rem;"></i>
                    </div>
                    {% endif %}
                    
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ product.name }}</h5>
                        <p class="card-text text-muted">{{ product.description[:100] }}{% if product.description|length > 100 %}...{% endif %}</p>
                        <div class="mt-auto">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <span class="h5 text-primary mb-0">₹{{ "%.2f"|format(product.price) }}</span>
                                <div>
                                    <span class="badge bg-secondary me-1">{{ product.category }}</span>
                                    {% if product.subcategory %}
                                    <span class="badge bg-info">{{ product.subcategory }}</span>
                                    {% endif %}
                                </div>
                            </div>
                            
                            {% if product.colors_list or product.sizes_list %}
                            <div class="mb-3">
                                {% if product.colors_list %}
                                <div class="mb-2">
                                    <small class="text-muted">
                                        <strong>Colors:</strong> 
                                        {% for color in product.colors_list[:3] %}
                                            <span class="badge bg-light text-dark me-1">{{ color }}</span>
                                        {% endfor %}
                                        {% if product.colors_list|length > 3 %}
                                            <span class="badge bg-light text-dark">+{{ product.colors_list|length - 3 }} more</span>
                                        {% endif %}
                                    </small>
                                </div>
                                {% endif %}
                                
                                {% if product.sizes_list %}
                                <div class="mb-2">
                                    <small class="text-muted">
                                        <strong>Sizes:</strong> 
                                        {% for size in product.sizes_list[:3] %}
                                            <span class="badge bg-light text-dark me-1">{{ size }}</span>
                                        {% endfor %}
                                        {% if product.sizes_list|length > 3 %}
                                            <span class="badge bg-light text-dark">+{{ product.sizes_list|length - 3 }} more</span>
                                        {% endif %}
                                    </small>
                                </div>
                                {% endif %}
                            </div>
                            {% endif %}
                            <div class="d-grid gap-2">
                                <a href="{{ url_for('product_detail', product_id=product.id) }}" class="btn btn-outline-primary">
                                    <i class="fas fa-eye me-2"></i>View Details
                                </a>
                                <a href="{{ url_for('add_to_cart', product_id=product.id) }}" class="btn btn-primary">
                                    <i class="fas fa-cart-plus me-2"></i>Add to Cart
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="col-12">
                <div class="text-center py-5">
                    <i class="fas fa-box-open text-muted" style="font-size: 4rem;"></i>
                    <h3 class="mt-3 text-muted">No products available</h3>
                    <p class="text-muted">Check back later for new products!</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="mt-5 fade-in py-5 bg-light">
    <div class="container">
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card text-center h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <i class="fas fa-shipping-fast text-primary mb-3" style="font-size: 3rem;"></i>
                        <h5 class="card-title">Fast Shipping</h5>
                        <p class="card-text">Get your orders delivered quickly and safely.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <i class="fas fa-shield-alt text-primary mb-3" style="font-size: 3rem;"></i>
                        <h5 class="card-title">Secure Payment</h5>
                        <p class="card-text">Your payment information is always protected.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <i class="fas fa-headset text-primary mb-3" style="font-size: 3rem;"></i>
                        <h5 class="card-title">24/7 Support</h5>
                        <p class="card-text">We're here to help you anytime, anywhere.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    /* Hero Section Styles */
    .hero-section {
        min-height: 80vh;
        background-color: #ffffff;
        position: relative;
        overflow: hidden;
    }

    .hero-content {
        padding: 3rem 2rem;
        display: flex;
        align-items: center;
        justify-content: flex-start;
    }

    .hero-text-container {
        max-width: 500px;
    }

    .hero-heading {
        margin-bottom: 1.5rem;
        line-height: 0.5;
    }

    .hero-line-1 {
        display: block;
        font-family: 'Montserrat', sans-serif;
        font-weight: 1000;
        font-size: 3.5rem;
        color: #000000;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    .hero-line-2 {
        display: block;
        font-family: 'Montserrat', sans-serif;
        font-weight: 800;
        font-size: 3.5rem;
        color: #db1024;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .hero-subheading {
        font-family: 'Open Sans', sans-serif;
        font-size: 1.25rem;
        color: #000000;
        margin-bottom: 2.5rem;
        line-height: 1.6;
        font-weight: 400;
    }

    .hero-button-container {
        margin-top: 1rem;
    }

    .hero-btn {
        padding: 10px 40px;
        font-size: 1.25rem;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(210, 2, 22, 0.3);
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .hero-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(130, 34, 44, 0.5);
    }

    /* Right Side - Image */
    .hero-image-container {
        padding: 0;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .hero-image-wrapper {
        width: 100%;
        height: 100%;
        overflow: hidden;
        position: relative;
    }

    .hero-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        transition: transform 0.3s ease;
    }

    

    /* Section Heading Styles */
    .section-heading {
        font-family: 'Montserrat', sans-serif;
        font-weight: 800;
        font-size: 3rem;
        color: #000000;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 1rem;
        line-height: 1.2;
    }

    .section-subheading {
        font-family: 'Open Sans', sans-serif;
        font-size: 1.1rem;
        color: #6c757d;
        font-weight: 300;
        line-height: 1.6;
        margin-bottom: 0;
    }

    /* Responsive Design */
    @media (max-width: 991.98px) {
        .hero-section {
            min-height: auto;
            padding: 2rem 0;
        }

        .hero-content {
            padding: 2rem 1.5rem;
            justify-content: center;
            text-align: center;
            order: 1;
        }

        .hero-image-container {
            order: 2;
            height: 50vh;
            min-height: 300px;
        }

        .hero-text-container {
            max-width: 100%;
        }

        .hero-line-1,
        .hero-line-2 {
            font-size: 2.8rem;
        }

        .hero-subheading {
            font-size: 1.1rem;
        }

        .section-heading {
            font-size: 2.5rem;
            letter-spacing: 2px;
        }

        .section-subheading {
            font-size: 1rem;
        }
    }

    @media (max-width: 767.98px) {
        .hero-content {
            padding: 1.5rem 1rem;
        }

        .hero-image-container {
            height: 40vh;
            min-height: 250px;
        }

        .hero-line-1,
        .hero-line-2 {
            font-size: 2.2rem;
            letter-spacing: 1px;
        }

        .hero-subheading {
            font-size: 1rem;
            margin-bottom: 2rem;
        }

        .hero-btn {
            padding: 12px 30px;
            font-size: 1.1rem;
        }

        .section-heading {
            font-size: 2rem;
            letter-spacing: 1.5px;
        }

        .section-subheading {
            font-size: 0.95rem;
        }
    }

    @media (max-width: 575.98px) {
        .hero-line-1,
        .hero-line-2 {
            font-size: 1.8rem;
        }

        .hero-subheading {
            font-size: 0.95rem;
        }

        .hero-btn {
            padding: 10px 25px;
            font-size: 1rem;
        }

        .section-heading {
            font-size: 1.6rem;
            letter-spacing: 1px;
        }

        .section-subheading {
            font-size: 0.9rem;
        }
    }

    /* Product Cards Enhancement */
    .card {
        transition: all 0.3s ease;
        border: 1px solid var(--border-color);
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        background: var(--primary-color);
        overflow: hidden;
    }

    .card:hover {
        transform: translateY(-8px);
        box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }

    .product-image {
        height: 250px;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .card:hover .product-image {
        transform: scale(1.05);
    }

    /* Smooth animations */
    .fade-in {
        animation: fadeIn 0.8s ease-in;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Loading optimization */
    .lazy-load {
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .lazy-load.loaded {
        opacity: 1;
    }

    /* Search and Filter Styles */
    #searchInput {
        border-radius: 25px 0 0 25px;
        border: 2px solid #e9ecef;
        padding: 12px 20px;
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    #searchInput:focus {
        border-color: #007bff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }

    #searchBtn {
        border-radius: 0 25px 25px 0;
        border: 2px solid #007bff;
        padding: 12px 20px;
        transition: all 0.3s ease;
    }

    #searchBtn:hover {
        background-color: #0056b3;
        border-color: #0056b3;
    }

    .dropdown-toggle {
        border-radius: 25px;
        padding: 10px 20px;
        border: 2px solid #6c757d;
        transition: all 0.3s ease;
    }

    .dropdown-toggle:hover {
        background-color: #6c757d;
        border-color: #6c757d;
        color: white;
    }

    .dropdown-menu {
        border-radius: 15px;
        border: 2px solid #e9ecef;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .dropdown-item {
        padding: 10px 20px;
        transition: all 0.2s ease;
    }

    .dropdown-item:hover {
        background-color: #f8f9fa;
        color: #007bff;
    }
</style>

<script>
    // Lazy loading optimization
    document.addEventListener('DOMContentLoaded', function() {
        const images = document.querySelectorAll('.product-image');
        images.forEach(img => {
            if (img.complete) {
                img.classList.add('loaded');
            } else {
                img.addEventListener('load', function() {
                    this.classList.add('loaded');
                });
            }
        });

        // Hero image handling
        const heroImage = document.querySelector('.hero-image');
        if (heroImage) {
            const img = new Image();
            img.onload = function() {
                console.log('Hero image loaded successfully');
            };
            img.onerror = function() {
                console.log('Hero image failed to load');
            };
            img.src = '{{ url_for("static", filename="images/hero-banner.jpeg") }}';
        }

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Search and Filter Functionality
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const productCards = document.querySelectorAll('.col');
        let currentCategory = 'all';
        let currentSubcategory = 'all';
        let currentPrice = 'all';

        function filterProducts() {
            const searchTerm = searchInput.value.toLowerCase();
            
            productCards.forEach(card => {
                const productName = card.querySelector('.card-title').textContent.toLowerCase();
                const productDesc = card.querySelector('.card-text').textContent.toLowerCase();
                const categoryBadge = card.querySelector('.badge.bg-secondary');
                const subcategoryBadge = card.querySelector('.badge.bg-info');
                
                const productCategory = categoryBadge ? categoryBadge.textContent.toLowerCase() : '';
                const productSubcategory = subcategoryBadge ? subcategoryBadge.textContent.toLowerCase() : '';
                const productPrice = parseFloat(card.querySelector('.h5').textContent.replace('₹', ''));
                
                let showCard = true;
                
                // Enhanced search filter - search in name, description, category, and subcategory
                if (searchTerm) {
                    const searchInName = productName.includes(searchTerm);
                    const searchInDesc = productDesc.includes(searchTerm);
                    const searchInCategory = productCategory.includes(searchTerm);
                    const searchInSubcategory = productSubcategory.includes(searchTerm);
                    
                    if (!searchInName && !searchInDesc && !searchInCategory && !searchInSubcategory) {
                        showCard = false;
                    }
                }
                
                // Category filter
                if (currentCategory !== 'all' && productCategory !== currentCategory) {
                    showCard = false;
                }
                
                // Subcategory filter
                if (currentSubcategory !== 'all' && productSubcategory !== currentSubcategory) {
                    showCard = false;
                }
                
                // Price filter
                if (currentPrice !== 'all') {
                    if (currentPrice === 'low' && productPrice >= 500) showCard = false;
                    if (currentPrice === 'medium' && (productPrice < 500 || productPrice > 1000)) showCard = false;
                    if (currentPrice === 'high' && productPrice <= 1000) showCard = false;
                }
                
                card.style.display = showCard ? 'block' : 'none';
            });
        }

        // Search functionality
        searchBtn.addEventListener('click', filterProducts);
        searchInput.addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                filterProducts();
            }
        });

        // Category filter
        document.querySelectorAll('[data-category]').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                currentCategory = this.getAttribute('data-category');
                document.getElementById('categoryFilter').textContent = this.textContent;
                filterProducts();
            });
        });

        // Subcategory filter
        document.querySelectorAll('[data-subcategory]').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                currentSubcategory = this.getAttribute('data-subcategory');
                document.getElementById('subcategoryFilter').textContent = this.textContent;
                filterProducts();
            });
        });

        // Price filter
        document.querySelectorAll('[data-price]').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                currentPrice = this.getAttribute('data-price');
                document.getElementById('priceFilter').textContent = this.textContent;
                filterProducts();
            });
        });
    });
</script>
{% endblock %}
